# Latent Dirichelet Allocation
潜在的ディリクレ配分法

## 概要
言語処理におけるトピックモデル<br>
1つの文書が複数のトピックからなるということを仮定した言語モデル<br>
単語→表層的な表現：トピック→潜在的な表現
### なぜトピックモデル使用するのか？
文書クラスタリングや文書ベクトル,単語ベクトルを作る際に利用する<br>
文書がどんなトピック(数は指定できるがトピック自体はわからない)でどんな割合で構成されているかを知ることができる<br>
文書や単語のトピック構成割合を確率ベクトルで知ることができる<br>
→文書や単語のトピックの出現確率の分布を知りたい！！

## 理解する上でのPoint
### - 事前分布・事後分布
#### 事前分布・事後分布って？
「パラメーターがどうような値をとるのか」という「見込みの大きさ」を確率分布として表したもの<br>
事象が起こる前の確率分布と事象が起こった後の確率分布<br>
事前分布：事象が起こる前に持っている情報での確率分布<br>
事後分布：事前に持っていた情報に加え、起こった事象を考慮した確率分布
#### 関係性
ここでベイズ推定が重要になる<br>
ベイズ推定は事後分布=尤度関数×事前分布の関係性を利用してデータが入ってくるたびに逐次的にパラメーター推定ができる仕組み<br>
算出した事後分布が次にデータが入ってきたときに事前分布となり再び事後分布を算出できる
##### ちなみに尤度関数とは？
パラメーターの確率分布を基に値の尤もらしさを計算する関数<br>
観察データの下での仮説の尤度関数<br>
#### 共役事前分布
ベイズ推定における事前分布と事後分布の形が同じになるやーつ<br>
この共役事前分布をもつ確率分布として(ディリクレ分布,多項分布),(二項分布,ベータ分布)などがある

### - 確率分布
#### そもそも確率分布って？
ある事象が起こる確率<br>
この確率をより正確なものに近づけるためには試行を繰り返すしかない<br>
→これは現実的でない<br>
→→少ない試行でもより正確な確率を求めらるためのモデルが確率分布<br>
#### 確率分布を用いると？
確率分布をいくつか用いることで少ないデータでもおおよその確率が効率よく算出できる<br>
各事象に発生確率を対応させることができる<br>
#### LDAで使用する確率分布は？
-多項分布<br>
-ディリクレ分布<br>
#### 多項分布
ある標本空間において起こりうる事象がK種類(3以上)あるときに適用することで起こりうる事象のパターンの確率を計算することができる<br>
→つまり確率Piで事象Ai(i=1,...,k)が起こるような試行をN回繰り返したときの「どの事象が何回起こったか」を表したいときに用いる確率分布<br>
LDAにおける尤度関数<br>
→その各事象の起こった回数の組み合わせが尤もらしいのかを確率で表現してくれる<br>
パラメーターはΘ：各事象が何回起こったかを渡したいのだが、それがわからないため、各事象の起こりやすさをパラメーターとして渡す<br>
→このパラメーターΘもわからないため推定する必要がある!!<br>
→→そこでディリクレ分布が登場する!!!
#### ディリクレ分布
多項分布の共役事前分布<br>
要するに多項分布のパラメーターを求めるための確率分布<br>
ディクレ分布のパラメーターはα：俗に言うハイパーパラメーター<br>

### - パラメーター推定
トピックモデルにおけるパラメーター→事後分布のパラメーター<br>
代表的な手法として<br>
-EMアルゴリズム<br>
-変分ベイズ推定<br>
-ギブスサンプリング←今回の実装で用いたパラメーター推定法<br>
#### ギブスサンプリング
1つのパラメーターがK次元である場合のサンプリング方法<br>
注目している次元を変数としてそれ以外のK-1次元を固定してサンプリングを行う<br>
Ex)任意の初期状態(x,y)から始めて以下を繰り返す<br>
1.xの新しい値を条件付き確率分布P(x|y)から選ぶ=この条件付き確率分布に従う変数xを取る<br>
←yは固定する<br>
→(x',y)<br>
2.yの値しい値を条件付き確率分布P(y|x')から選ぶ<br>
←x'は固定する<br>
→ (x',y')<br>
というふうな流れでサンプリングを行う<br>
つまり、変数xの新しい値をサンプリングにするには条件付き確率p(x|y)を求める必要がある<br>
→ベイズ推定登場!!!
##### ベイズ推定
公式：P(x|y)=P(y|x)P(x)/P(y)<br>
P(x|y)：事後確率<br>
P(y|x)：尤度関数<br>
P(x)：事前確率<br>
→さらに多項分布&ディリクレ分布登場!!!<br>
##### なぜ多項分布&ディリクレ分布登場するのか？？
ディリクレ分布は多項分布の共役事前分布だから!<br>
→だから何??wwww<br>
→→共役事前分布はベイズ推定において事前確率と事後確率が同じ形になる<br>
つまり、ディリクレ分布×多項分布=ディリクレ分布という形になる!!<br>
→何がいいの？？wwww<br>
→→求めた事後確率(ディリクレ分布)が次のサンプリングにおいての事前確率(ディリクレ分布)として扱えるため、逐次的な(データが入ってくるたびに)サンプリングおよびパラメーター更新が行える!!!!!

## LDAプログラム
### main.scala
実行プログラム
### lda.scala
LDAの主動作の実装<br>
更新アルゴリム：崩壊型ギブスサンプリング<br>
### reader.scala
テキストデータの処理<br>
スペースでスプリットして単語群のcorpus作成
### test.scala
テストデータの読み込み
